# EdgeFlow - 边缘工作流自动化引擎

> 无代码边缘工作流自动化平台，类 Zapier 但运行在边缘

## 项目简介

EdgeFlow 是一个基于阿里云 ESA (边缘安全加速) 的无代码工作流自动化平台。用户可以通过可视化拖拽界面构建复杂的自动化工作流，所有工作流都在边缘节点执行，实现超低延迟和全球分布式处理。

### 核心特性

- **可视化工作流编辑器** - 拖拽式节点编辑，实时预览连接
- **丰富的节点类型** - 触发器、数据处理、AI 能力、边缘特性、输出动作
- **边缘原生执行** - 工作流在 ESA 边缘节点运行，毫秒级响应
- **AI 智能集成** - 内置通义千问 AI，支持分析、生成、分类等能力
- **实时执行监控** - 查看工作流执行历史和详细日志

## 技术架构

```
┌─────────────────────────────────────────────────────────────┐
│                      用户浏览器                              │
│  ┌─────────────────────────────────────────────────────┐   │
│  │              React + Tailwind CSS                    │   │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────────────┐    │   │
│  │  │ 节点面板  │ │ 画布编辑 │ │ 配置面板          │    │   │
│  │  └──────────┘ └──────────┘ └──────────────────┘    │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    ESA Edge Functions                        │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                  工作流执行引擎                       │   │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────────────┐    │   │
│  │  │ Webhook  │ │ AI 处理  │ │ KV 存储           │    │   │
│  │  └──────────┘ └──────────┘ └──────────────────┘    │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    外部服务集成                              │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐      │
│  │ 通义千问  │ │ HTTP API │ │ 邮件服务  │ │ 其他服务  │      │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘      │
└─────────────────────────────────────────────────────────────┘
```

## 节点类型

### 触发器 (Triggers)
| 节点 | 说明 |
|------|------|
| Webhook | 接收 HTTP 请求触发工作流 |
| 定时触发 | 按 Cron 表达式定时执行 |
| 地理触发 | 基于访问者地理位置触发 |

### 数据处理 (Data Processing)
| 节点 | 说明 |
|------|------|
| 转换 | JavaScript 表达式转换数据 |
| 过滤 | 条件过滤，控制流程继续 |
| 合并 | 合并多个数据源 |

### AI 能力 (AI Capabilities)
| 节点 | 说明 |
|------|------|
| AI 分析 | 使用 AI 分析数据趋势和异常 |
| AI 生成 | AI 生成文本、报告等内容 |
| AI 分类 | 自动分类内容到预设类别 |

### 边缘能力 (Edge Features)
| 节点 | 说明 |
|------|------|
| 边缘缓存 | 利用 ESA 缓存加速响应 |
| 边缘 KV | 读写边缘 KV 存储 |
| 边缘重定向 | 智能重定向请求 |

### 输出动作 (Output Actions)
| 节点 | 说明 |
|------|------|
| HTTP 请求 | 发送 HTTP 请求到外部 API |
| 邮件通知 | 发送邮件通知 |
| 响应 | 返回自定义 HTTP 响应 |

## 项目结构

```
12_EdgeFlow_工作流自动化/
├── frontend/                    # 前端应用
│   ├── src/
│   │   ├── components/         # React 组件
│   │   │   ├── WorkflowCanvas.jsx   # 工作流画布
│   │   │   ├── NodePanel.jsx        # 节点选择面板
│   │   │   ├── NodeConfigPanel.jsx  # 节点配置面板
│   │   │   └── Header.jsx           # 页面头部
│   │   ├── pages/              # 页面组件
│   │   │   ├── HomePage.jsx         # 首页/工作流列表
│   │   │   ├── EditorPage.jsx       # 工作流编辑器
│   │   │   └── ExecutionsPage.jsx   # 执行历史
│   │   ├── store/              # 状态管理
│   │   │   └── index.js             # Zustand store
│   │   ├── App.jsx             # 应用入口
│   │   ├── main.jsx            # React 入口
│   │   └── index.css           # 全局样式
│   ├── public/                 # 静态资源
│   ├── package.json
│   ├── vite.config.js
│   └── tailwind.config.js
├── functions/                   # Edge Functions
│   ├── index.js                # 主入口
│   ├── workflow/               # 工作流模块
│   │   ├── execute.js          # 执行引擎
│   │   └── webhook.js          # Webhook 处理
│   └── edge/                   # 边缘能力模块
│       ├── ai.js               # AI 处理
│       └── kv.js               # KV 存储
└── README.md
```

## 快速开始

### 环境要求

- Node.js 18+
- npm 或 yarn

### 本地开发

```bash
# 进入前端目录
cd frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

访问 http://localhost:5193 查看应用。

### 构建部署

```bash
# 构建前端
cd frontend
npm run build

# 部署到 ESA Pages
# 将 dist 目录和 functions 目录上传到 ESA Pages
```

## 使用指南

### 创建工作流

1. 点击首页的「创建工作流」按钮
2. 输入工作流名称和描述
3. 进入编辑器页面

### 编辑工作流

1. 从左侧节点面板选择节点类型
2. 点击节点添加到画布
3. 拖拽节点调整位置
4. 点击节点输出端口，再点击目标节点输入端口完成连接
5. 选中节点后在右侧面板配置参数

### 测试工作流

1. 点击工具栏的「测试」按钮
2. 输入测试数据
3. 查看执行结果和日志

### 部署工作流

1. 保存工作流
2. 点击「部署」按钮
3. 工作流将部署到边缘节点

## 工作流模板

### 地理位置重定向
根据访问者地理位置自动重定向到不同页面，适用于多语言网站。

### AI 内容过滤
使用 AI 自动分类和过滤用户提交的内容，适用于 UGC 平台。

### 智能边缘缓存
根据请求特征智能缓存响应，提升 API 性能。

### 定时报告生成
定时收集数据并使用 AI 生成报告，适用于数据分析场景。

## API 参考

### 执行工作流
```
POST /api/workflow/execute
Content-Type: application/json

{
  "workflow": { ... },
  "triggerData": { ... }
}
```

### Webhook 触发
```
POST /api/webhook/{webhookId}
Content-Type: application/json

{
  "data": { ... }
}
```

### AI 处理
```
POST /api/ai/process
Content-Type: application/json

{
  "action": "analyze|generate|classify|summarize|extract",
  "data": { ... },
  "config": { ... }
}
```

### KV 操作
```
GET /api/kv/{namespace}/{key}
PUT /api/kv/{namespace}/{key}
DELETE /api/kv/{namespace}/{key}
```

## ESA 边缘特性利用

1. **Edge Functions** - 工作流执行引擎运行在边缘
2. **Edge Cache** - 缓存工作流执行结果
3. **Edge KV** - 存储工作流配置和状态
4. **Geo Location** - 获取访问者地理位置信息
5. **全球分布** - 工作流在最近的边缘节点执行

## 技术栈

### 前端
- React 18
- React Router 6
- Zustand (状态管理)
- Tailwind CSS
- Framer Motion (动画)
- Vite (构建工具)

### 后端
- ESA Edge Functions
- 通义千问 API (AI 能力)

## 开发计划

- [ ] 工作流版本管理
- [ ] 团队协作功能
- [ ] 更多触发器类型
- [ ] 自定义节点开发
- [ ] 工作流市场
- [ ] 执行统计分析

## 许可证

MIT License

## 联系方式

如有问题或建议，请提交 Issue 或 Pull Request。
